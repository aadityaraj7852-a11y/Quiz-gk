<!doctype html>
<html>
<body>
<button onclick="downloadDocx()">Download DOCX</button>

<script>
function downloadDocx(){

  const documentXml = `
  <?xml version="1.0" encoding="UTF-8" standalone="yes"?>
  <w:document xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main">
    <w:body>
      <w:p>
        <w:r><w:t>Hello Aadi, DOCX working!</w:t></w:r>
      </w:p>
    </w:body>
  </w:document>`;

  const contentTypes = `
  <?xml version="1.0" encoding="UTF-8"?>
  <Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">
    <Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/>
    <Default Extension="xml" ContentType="application/xml"/>
    <Override PartName="/word/document.xml" 
      ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml"/>
  </Types>`;

  const rels = `
  <?xml version="1.0"?>
  <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
  </Relationships>`;

  const docrels = `
  <?xml version="1.0"?>
  <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
  </Relationships>`;

  const files = {
    "[Content_Types].xml": contentTypes,
    "_rels/.rels": rels,
    "word/_rels/document.xml.rels": docrels,
    "word/document.xml": documentXml
  };

  const zip = makeZip(files);
  const blob = new Blob([zip], {type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "test.docx";
  a.click();
}

function makeZip(files){
  function str2buf(s){ return new TextEncoder().encode(s); }
  function u32(n){ return [n&255,(n>>8)&255,(n>>16)&255,(n>>24)&255]; }

  let out=[], cen=[], offset=0;

  for(const name in files){
    const data=str2buf(files[name]);
    const fn=str2buf(name);

    const lh=new Uint8Array(30+fn.length);
    lh.set([80,75,3,4],0);
    lh.set([20,0],4);
    lh.set([0,0],6);
    lh.set([0,0],8);
    lh.set([0,0,0,0],10);
    lh.set(u32(0),14);
    lh.set(u32(data.length),18);
    lh.set(u32(data.length),22);
    lh.set([fn.length,0],26);
    lh.set(fn,30);

    out.push(lh,data);

    const ch=new Uint8Array(46+fn.length);
    ch.set([80,75,1,2],0);
    ch.set([20,0],4);
    ch.set([20,0],6);
    ch.set([0,0],8);
    ch.set([0,0,0,0],12);
    ch.set(u32(0),16);
    ch.set(u32(data.length),20);
    ch.set(u32(data.length),24);
    ch.set([fn.length,0],28);
    ch.set([0,0],32);
    ch.set([0,0],36);
    ch.set(u32(offset),42);
    ch.set(fn,46);

    cen.push(ch);

    offset += lh.length + data.length;
  }

  let cenStart = offset;
  cen.forEach(c=>{ out.push(c); offset+=c.length; });

  const end=new Uint8Array(22);
  end.set([80,75,5,6],0);
  end.set([cen.length,0],8);
  end.set([cen.length,0],10);
  end.set(u32(offset-cenStart),12);
  end.set(u32(cenStart),16);

  out.push(end);

  let size = out.reduce((a,b)=>a+b.length,0);
  let buf=new Uint8Array(size);
  let p=0;
  out.forEach(b=>{ buf.set(b,p); p+=b.length; });

  return buf;
}
</script>
</body>
</html>
